{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import torch\n",
    "import plotly.express as px\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from torch.distributions.gamma import Gamma\n",
    "torch.manual_seed(0)\n",
    "obese_weights = Gamma(concentration=20,rate=0.1).rsample((100,))\n",
    "non_obese_weights = Gamma(concentration=10,rate=1.0).rsample((200,))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>weight</th>\n",
       "      <th>obese</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>273.226562</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>183.938828</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>152.385315</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>140.934738</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>166.463028</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>10.126618</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>7.515701</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>10.469541</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>10.216485</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>4.516290</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>300 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         weight  obese\n",
       "0    273.226562   True\n",
       "1    183.938828   True\n",
       "2    152.385315   True\n",
       "3    140.934738   True\n",
       "4    166.463028   True\n",
       "..          ...    ...\n",
       "295   10.126618  False\n",
       "296    7.515701  False\n",
       "297   10.469541  False\n",
       "298   10.216485  False\n",
       "299    4.516290  False\n",
       "\n",
       "[300 rows x 2 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obese_df = pd.DataFrame(obese_weights, columns=[\"weight\"])\n",
    "obese_df[\"obese\"] = True\n",
    "non_obese_df = pd.DataFrame(non_obese_weights, columns=[\"weight\"])\n",
    "non_obese_df[\"obese\"] = False\n",
    "df = pd.concat([obese_df, non_obese_df], axis=0, ignore_index=True)\n",
    "csv_path = \"../../tests/expected/TestLogisticRegressionApp/mice.csv\"\n",
    "df.to_csv(csv_path, index=False)\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "boxpoints": "all",
         "hovertemplate": "obese=%{y}<br>weight=%{x}<extra></extra>",
         "legendgroup": "True",
         "marker": {
          "color": "#636efa"
         },
         "name": "True",
         "notched": false,
         "offsetgroup": "True",
         "orientation": "h",
         "showlegend": true,
         "type": "box",
         "x": [
          273.2265625,
          183.93882751464844,
          152.38531494140625,
          140.9347381591797,
          166.46302795410156,
          179.31634521484375,
          161.0694122314453,
          249.6243896484375,
          172.60598754882812,
          213.6815948486328,
          213.55409240722656,
          268.58770751953125,
          205.298828125,
          258.2048034667969,
          195.74217224121094,
          166.49386596679688,
          205.30455017089844,
          221.73236083984375,
          154.44544982910156,
          175.2848358154297,
          194.87954711914062,
          209.72251892089844,
          152.23342895507812,
          185.07920837402344,
          302.7546691894531,
          195.0999755859375,
          249.55401611328125,
          345.9888000488281,
          137.17254638671875,
          168.78619384765625,
          184.30039978027344,
          190.8080596923828,
          177.03050231933594,
          182.13967895507812,
          265.22442626953125,
          253.3074188232422,
          143.16766357421875,
          238.688232421875,
          206.76669311523438,
          222.17428588867188,
          202.57089233398438,
          245.4453582763672,
          156.48435974121094,
          229.92422485351562,
          169.38082885742188,
          189.6953887939453,
          207.7763671875,
          190.9069061279297,
          209.063720703125,
          222.94297790527344,
          262.496826171875,
          322.4184875488281,
          105.25997924804688,
          238.1065216064453,
          219.62603759765625,
          174.3596954345703,
          172.89300537109375,
          191.40554809570312,
          152.24685668945312,
          196.8621826171875,
          168.0648651123047,
          266.876220703125,
          298.7705993652344,
          230.26963806152344,
          214.7351837158203,
          200.66156005859375,
          121.58211517333984,
          225.8560333251953,
          211.8444366455078,
          278.97125244140625,
          254.18763732910156,
          256.1336975097656,
          249.9869384765625,
          227.30409240722656,
          203.15826416015625,
          140.19442749023438,
          211.56527709960938,
          139.3211212158203,
          158.3321533203125,
          233.07411193847656,
          155.8807830810547,
          282.00146484375,
          245.8300323486328,
          151.02377319335938,
          252.904296875,
          203.4828338623047,
          122.623779296875,
          145.19093322753906,
          183.77259826660156,
          273.5133361816406,
          176.27523803710938,
          281.8180847167969,
          191.00570678710938,
          244.75328063964844,
          175.51783752441406,
          295.4339599609375,
          189.0066680908203,
          212.7355499267578,
          193.63656616210938,
          112.55931854248047
         ],
         "x0": " ",
         "xaxis": "x",
         "y": [
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true,
          true
         ],
         "y0": " ",
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "boxpoints": "all",
         "hovertemplate": "obese=%{y}<br>weight=%{x}<extra></extra>",
         "legendgroup": "False",
         "marker": {
          "color": "#EF553B"
         },
         "name": "False",
         "notched": false,
         "offsetgroup": "False",
         "orientation": "h",
         "showlegend": true,
         "type": "box",
         "x": [
          8.321928977966309,
          9.138261795043945,
          5.590944290161133,
          8.41641902923584,
          12.53220272064209,
          8.182178497314453,
          12.423873901367188,
          9.416242599487305,
          7.6153106689453125,
          11.487029075622559,
          10.84287166595459,
          11.424654960632324,
          10.829717636108398,
          12.359272003173828,
          10.921266555786133,
          16.110044479370117,
          9.057662963867188,
          14.140036582946777,
          8.722007751464844,
          12.98784065246582,
          12.004983901977539,
          14.698638916015625,
          10.846467018127441,
          10.903694152832031,
          7.535733699798584,
          6.881626129150391,
          7.9465131759643555,
          11.349711418151855,
          9.95360279083252,
          9.434041976928711,
          10.32354736328125,
          13.093544960021973,
          23.140928268432617,
          9.009048461914062,
          14.221656799316406,
          9.181628227233887,
          7.394266605377197,
          8.891069412231445,
          15.51257038116455,
          7.883660793304443,
          13.587615013122559,
          12.652795791625977,
          11.88100528717041,
          12.175426483154297,
          7.4273834228515625,
          6.408417224884033,
          7.9375410079956055,
          5.246946811676025,
          6.193667411804199,
          13.609967231750488,
          8.10288143157959,
          8.090619087219238,
          14.534676551818848,
          10.492304801940918,
          13.160894393920898,
          10.012877464294434,
          12.2462797164917,
          7.103148937225342,
          9.334482192993164,
          13.730907440185547,
          8.068334579467773,
          7.939988136291504,
          10.48996353149414,
          8.011178970336914,
          8.870841979980469,
          8.628507614135742,
          6.942720413208008,
          11.297722816467285,
          8.529850006103516,
          14.06041431427002,
          6.17800235748291,
          9.502449035644531,
          14.531669616699219,
          9.194332122802734,
          12.371604919433594,
          4.50185489654541,
          6.461740016937256,
          10.524627685546875,
          4.377554893493652,
          8.970917701721191,
          9.77635669708252,
          12.9037446975708,
          7.861830711364746,
          10.753442764282227,
          7.89311408996582,
          9.872207641601562,
          13.417557716369629,
          6.93332576751709,
          12.987194061279297,
          9.851641654968262,
          7.527156829833984,
          7.740129470825195,
          12.31792163848877,
          8.581563949584961,
          23.146018981933594,
          8.711980819702148,
          11.000245094299316,
          5.002901554107666,
          10.791584014892578,
          6.421891212463379,
          10.041478157043457,
          7.821338176727295,
          9.297200202941895,
          8.189383506774902,
          5.823548316955566,
          12.203468322753906,
          4.053441524505615,
          14.596168518066406,
          6.445913314819336,
          12.534066200256348,
          9.298842430114746,
          12.034720420837402,
          10.385099411010742,
          11.351173400878906,
          14.359472274780273,
          11.516583442687988,
          14.677915573120117,
          7.978238582611084,
          17.6151180267334,
          9.692420959472656,
          8.631182670593262,
          10.498503684997559,
          5.718039035797119,
          12.455561637878418,
          7.219902038574219,
          10.487306594848633,
          12.412918090820312,
          4.751680374145508,
          7.56038236618042,
          7.001536846160889,
          12.440265655517578,
          8.876205444335938,
          19.459209442138672,
          11.151726722717285,
          6.523715972900391,
          5.103715419769287,
          7.880472660064697,
          10.635907173156738,
          9.277021408081055,
          6.898979187011719,
          12.76130199432373,
          13.553144454956055,
          11.420432090759277,
          8.202024459838867,
          10.285266876220703,
          9.837461471557617,
          3.362531900405884,
          6.310499668121338,
          9.654766082763672,
          5.556596279144287,
          5.80169153213501,
          4.1380414962768555,
          15.06879711151123,
          10.364653587341309,
          5.772058963775635,
          10.894661903381348,
          8.79061222076416,
          5.6898274421691895,
          7.587447643280029,
          5.422359466552734,
          3.7601277828216553,
          12.27158260345459,
          11.152240753173828,
          11.653149604797363,
          9.0324068069458,
          12.886763572692871,
          7.952364444732666,
          13.434137344360352,
          18.235071182250977,
          8.961745262145996,
          6.68378210067749,
          8.910799980163574,
          9.756300926208496,
          6.233569145202637,
          18.16819953918457,
          14.272421836853027,
          8.241670608520508,
          17.005970001220703,
          7.3820977210998535,
          10.472882270812988,
          8.049973487854004,
          12.019512176513672,
          4.018538951873779,
          6.508602619171143,
          8.996224403381348,
          8.955446243286133,
          18.3350830078125,
          6.898468971252441,
          8.554909706115723,
          8.370279312133789,
          15.204371452331543,
          18.003559112548828,
          7.0609259605407715,
          13.787802696228027,
          10.410065650939941,
          10.126618385314941,
          7.515700817108154,
          10.4695405960083,
          10.216485023498535,
          4.516289710998535
         ],
         "x0": " ",
         "xaxis": "x",
         "y": [
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false,
          false
         ],
         "y0": " ",
         "yaxis": "y"
        }
       ],
       "layout": {
        "boxmode": "overlay",
        "legend": {
         "title": {
          "text": "obese"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "showlegend": false,
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "#E5ECF6",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "white"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "#E5ECF6",
          "polar": {
           "angularaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "radialaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "yaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "zaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "caxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          }
         }
        },
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "weight"
         }
        },
        "yaxis": {
         "anchor": "x",
         "categoryarray": [
          false,
          true
         ],
         "categoryorder": "array",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "obese"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig = px.box(df, x=\"weight\", y=\"obese\", color=\"obese\", points=\"all\")\n",
    "fig.update_layout(\n",
    "    showlegend=False,\n",
    ")\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "from fastapp.examples.logistic_regression import LogisticRegressionApp\n",
    "\n",
    "app = LogisticRegressionApp()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "mean = df[\"weight\"].mean()\n",
    "std = df[\"weight\"].std()\n",
    "df[\"weight\"] = (df[\"weight\"] - mean)/std"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Building dataloaders</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1mBuilding dataloaders\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Building model</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1mBuilding model\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Building learner</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1mBuilding learner\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000\">Setting floating-point precision of learner to </span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span><span style=\"color: #800000; text-decoration-color: #800000\"> bit</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[31mSetting floating-point precision of learner to \u001b[0m\u001b[1;36m16\u001b[0m\u001b[31m bit\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">--------------------------------------------------------------------------</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1;31m--------------------------------------------------------------------------\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Please cite these references if using this app in an academic publication:</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1;31mPlease cite these references if using this app in an academic publication:\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] J. Howard and S. Gugger. Deep Learning for Coders with Fastai and Pytorch: AI Applications Without a PhD. O'Reilly Media, Incorporated, 2020. ISBN 9781492045526. URL: https://books.google.no/books?id=xd6LxgEACAAJ.\n",
      "[2] Jeremy Howard and Sylvain Gugger. Fastai: A Layered API for Deep Learning. Information, 2020. URL: https://www.mdpi.com/2078-2489/11/2/108, doi:10.3390/info11020108.\n",
      "[3] Robert Turnbull and Jonathan Garber. FastApp: A wrapper for fastai projects to create easy command-line inferfaces and manage hyper-parameter tuning. JOSS, 2022 (forthcoming).\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">--------------------------------------------------------------------------</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1;31m--------------------------------------------------------------------------\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "    /* Turns off some styling */\n",
       "    progress {\n",
       "        /* gets rid of default border in Firefox and Opera. */\n",
       "        border: none;\n",
       "        /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "        background-size: auto;\n",
       "    }\n",
       "    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "        background: #F44336;\n",
       "    }\n",
       "</style>\n"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>accuracy</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>28.210493</td>\n",
       "      <td>22.445812</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>28.539541</td>\n",
       "      <td>22.956032</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>29.137754</td>\n",
       "      <td>24.540947</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>30.057228</td>\n",
       "      <td>25.983988</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>30.497217</td>\n",
       "      <td>26.694792</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>31.022377</td>\n",
       "      <td>27.048388</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>31.479494</td>\n",
       "      <td>27.457541</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>31.802128</td>\n",
       "      <td>27.955477</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>32.286098</td>\n",
       "      <td>27.995213</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>32.726734</td>\n",
       "      <td>28.029558</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>10</td>\n",
       "      <td>32.990574</td>\n",
       "      <td>28.058989</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>11</td>\n",
       "      <td>33.440475</td>\n",
       "      <td>28.082388</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>12</td>\n",
       "      <td>33.359558</td>\n",
       "      <td>28.101854</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>13</td>\n",
       "      <td>33.389854</td>\n",
       "      <td>28.116863</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>14</td>\n",
       "      <td>33.509830</td>\n",
       "      <td>28.128279</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>15</td>\n",
       "      <td>33.627445</td>\n",
       "      <td>28.136253</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>16</td>\n",
       "      <td>33.684845</td>\n",
       "      <td>28.141109</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>33.774586</td>\n",
       "      <td>28.143829</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>18</td>\n",
       "      <td>33.698753</td>\n",
       "      <td>28.144899</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>19</td>\n",
       "      <td>33.822422</td>\n",
       "      <td>28.145081</td>\n",
       "      <td>0.716667</td>\n",
       "      <td>00:01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with accuracy value: 0.7166666388511658.\n"
     ]
    }
   ],
   "source": [
    "learner = app.train(csv=csv_path, x=\"weight\", y=\"obese\", learning_rate=1e-2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor([-0.7446, -0.7088, -0.6730, -0.6372, -0.6014, -0.5656, -0.5298, -0.4939,\n",
       "        -0.4581, -0.4223, -0.3865, -0.3507, -0.3149, -0.2791, -0.2433, -0.2075,\n",
       "        -0.1717, -0.1359, -0.1001, -0.0643, -0.0285,  0.0073,  0.0431,  0.0789,\n",
       "         0.1147,  0.1505,  0.1863,  0.2221,  0.2580,  0.2938,  0.3296,  0.3654,\n",
       "         0.4012,  0.4370,  0.4728,  0.5086,  0.5444,  0.5802,  0.6160,  0.6518,\n",
       "         0.6876,  0.7234,  0.7592,  0.7950,  0.8308,  0.8666,  0.9024,  0.9382,\n",
       "         0.9740,  1.0099,  1.0457,  1.0815,  1.1173,  1.1531,  1.1889,  1.2247,\n",
       "         1.2605,  1.2963,  1.3321,  1.3679,  1.4037,  1.4395,  1.4753,  1.5111,\n",
       "         1.5469,  1.5827,  1.6185,  1.6543,  1.6901,  1.7259,  1.7618,  1.7976,\n",
       "         1.8334,  1.8692,  1.9050,  1.9408,  1.9766,  2.0124,  2.0482,  2.0840,\n",
       "         2.1198,  2.1556,  2.1914,  2.2272,  2.2630,  2.2988,  2.3346,  2.3704,\n",
       "         2.4062,  2.4420,  2.4778,  2.5137,  2.5495,  2.5853,  2.6211,  2.6569,\n",
       "         2.6927,  2.7285,  2.7643,  2.8001])"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x = torch.linspace(df[\"weight\"].min(), df[\"weight\"].max(), 100)\n",
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "y = learner.model(x.unsqueeze(dim=-1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor([0.6336, 0.6301, 0.6267, 0.6232, 0.6197, 0.6162, 0.6127, 0.6092, 0.6057,\n",
       "        0.6021, 0.5986, 0.5950, 0.5915, 0.5879, 0.5843, 0.5807, 0.5771, 0.5735,\n",
       "        0.5698, 0.5662, 0.5626, 0.5589, 0.5553, 0.5516, 0.5479, 0.5443, 0.5406,\n",
       "        0.5369, 0.5332, 0.5296, 0.5259, 0.5222, 0.5185, 0.5148, 0.5111, 0.5074,\n",
       "        0.5037, 0.5000, 0.4963, 0.4926, 0.4889, 0.4852, 0.4815, 0.4778, 0.4741,\n",
       "        0.4704, 0.4667, 0.4630, 0.4594, 0.4557, 0.4520, 0.4484, 0.4447, 0.4411,\n",
       "        0.4374, 0.4338, 0.4301, 0.4265, 0.4229, 0.4193, 0.4157, 0.4121, 0.4085,\n",
       "        0.4049, 0.4014, 0.3978, 0.3943, 0.3908, 0.3872, 0.3837, 0.3802, 0.3768,\n",
       "        0.3733, 0.3698, 0.3664, 0.3630, 0.3595, 0.3561, 0.3528, 0.3494, 0.3460,\n",
       "        0.3427, 0.3394, 0.3361, 0.3328, 0.3295, 0.3262, 0.3230, 0.3197, 0.3165,\n",
       "        0.3133, 0.3102, 0.3070, 0.3039, 0.3007, 0.2976, 0.2946, 0.2915, 0.2884,\n",
       "        0.2854], grad_fn=<SqueezeBackward0>)"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y.squeeze()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "type": "scatter",
         "x": [
          2.047323226928711,
          1.1235891580581665,
          0.7971495389938354,
          0.6786865592002869,
          0.942791759967804,
          1.075766921043396,
          0.8869916200637817,
          1.803144931793213,
          1.0063443183898926,
          1.43129563331604,
          1.429976463317871,
          1.9993315935134888,
          1.3445709943771362,
          1.8919143676757812,
          1.2457016706466675,
          0.9431107640266418,
          1.3446301221847534,
          1.5145854949951172,
          0.8184628486633301,
          1.0340585708618164,
          1.2367773056030273,
          1.3903366327285767,
          0.7955781817436218,
          1.1353870630264282,
          2.352808952331543,
          1.2390577793121338,
          1.8024169206619263,
          2.800091505050659,
          0.6397644877433777,
          0.9668262600898743,
          1.1273298263549805,
          1.194655418395996,
          1.0521185398101807,
          1.104975938796997,
          1.9645365476608276,
          1.8412480354309082,
          0.701787531375885,
          1.6900039911270142,
          1.3597568273544312,
          1.5191575288772583,
          1.3163487911224365,
          1.7599103450775146,
          0.8395565748214722,
          1.5993351936340332,
          0.9729781150817871,
          1.183144211769104,
          1.3702025413513184,
          1.1956779956817627,
          1.3835209608078003,
          1.5271100997924805,
          1.9363179206848145,
          2.5562427043914795,
          0.3096102178096771,
          1.6839858293533325,
          1.492794394493103,
          1.0244873762130737,
          1.009313702583313,
          1.2008367776870728,
          0.7957171201705933,
          1.257288932800293,
          0.9593636989593506,
          1.9816253185272217,
          2.311591386795044,
          1.6029086112976074,
          1.4421955347061157,
          1.2965956926345825,
          0.4784723222255707,
          1.557247281074524,
          1.4122891426086426,
          2.106755495071411,
          1.8503544330596924,
          1.8704875707626343,
          1.8068957328796387,
          1.5722283124923706,
          1.3224256038665771,
          0.671027660369873,
          1.4094010591506958,
          0.6619927883148193,
          0.858673095703125,
          1.6319226026535034,
          0.8333122134208679,
          2.1381049156188965,
          1.763890027999878,
          0.7830635905265808,
          1.8370774984359741,
          1.325783371925354,
          0.48924893140792847,
          0.7227194309234619,
          1.121869444847107,
          2.050290107727051,
          1.0443048477172852,
          2.1362075805664062,
          1.1967002153396606,
          1.7527503967285156,
          1.0364691019058228,
          2.277071952819824,
          1.1760189533233643,
          1.4215081930160522,
          1.2239179611206055,
          0.38512617349624634,
          -0.6932709217071533,
          -0.6848254799842834,
          -0.7215245962142944,
          -0.6922933459281921,
          -0.6497131586074829,
          -0.69471675157547,
          -0.6508339047431946,
          -0.6819495558738708,
          -0.7005813121795654,
          -0.6605260968208313,
          -0.6671902537345886,
          -0.6611713767051697,
          -0.6673263311386108,
          -0.651502251625061,
          -0.6663792729377747,
          -0.6126982569694519,
          -0.6856592893600464,
          -0.6330791711807251,
          -0.6891318559646606,
          -0.6449993252754211,
          -0.6551675796508789,
          -0.6273000836372375,
          -0.6671530604362488,
          -0.6665610074996948,
          -0.7014045119285583,
          -0.7081717252731323,
          -0.6971548199653625,
          -0.661946713924408,
          -0.6763902306556702,
          -0.6817654371261597,
          -0.6725630164146423,
          -0.643905758857727,
          -0.5399596095085144,
          -0.6861622333526611,
          -0.6322347521781921,
          -0.6843768358230591,
          -0.7028681635856628,
          -0.6873828172683716,
          -0.618879497051239,
          -0.6978050470352173,
          -0.6387943029403687,
          -0.6484655737876892,
          -0.6564502120018005,
          -0.6534042358398438,
          -0.7025254964828491,
          -0.7130672931671143,
          -0.6972476840019226,
          -0.7250834107398987,
          -0.7152890563011169,
          -0.6385630369186401,
          -0.6955370903015137,
          -0.6956639289855957,
          -0.6289963722229004,
          -0.6708171367645264,
          -0.643208920955658,
          -0.675777018070221,
          -0.6526711583137512,
          -0.7058799266815186,
          -0.6827954649925232,
          -0.6373118758201599,
          -0.6958944797515869,
          -0.6972223520278931,
          -0.6708413362503052,
          -0.6964858174324036,
          -0.687592089176178,
          -0.6900991797447205,
          -0.7075396776199341,
          -0.6624845862388611,
          -0.691119909286499,
          -0.633902907371521,
          -0.7154511213302612,
          -0.6810577511787415,
          -0.6290274858474731,
          -0.6842453479766846,
          -0.6513746380805969,
          -0.7327918410301208,
          -0.712515652179718,
          -0.6704826951026917,
          -0.7340777516365051,
          -0.6865567564964294,
          -0.6782239675521851,
          -0.6458693146705627,
          -0.6980308890342712,
          -0.668115496635437,
          -0.6977072954177856,
          -0.6772323846817017,
          -0.6405536532402039,
          -0.707636833190918,
          -0.645006000995636,
          -0.6774451732635498,
          -0.7014932632446289,
          -0.6992899775505066,
          -0.651930034160614,
          -0.6905848383903503,
          -0.5399069786071777,
          -0.6892355680465698,
          -0.6655621528625488,
          -0.7276082038879395,
          -0.6677209138870239,
          -0.7129279375076294,
          -0.6754811406135559,
          -0.6984498500823975,
          -0.68318110704422,
          -0.694642186164856,
          -0.7191181182861328,
          -0.6531140804290771,
          -0.7374308705329895,
          -0.6283602118492126,
          -0.712679386138916,
          -0.6496939063072205,
          -0.6831641793251038,
          -0.6548599004745483,
          -0.6719262003898621,
          -0.661931574344635,
          -0.63080894947052,
          -0.6602203249931335,
          -0.6275144815444946,
          -0.6968265771865845,
          -0.597127377986908,
          -0.6790923476219177,
          -0.6900715231895447,
          -0.6707529425621033,
          -0.7202096581459045,
          -0.6505060195922852,
          -0.7046720385551453,
          -0.6708688139915466,
          -0.6509472131729126,
          -0.7302072644233704,
          -0.701149582862854,
          -0.7069311738014221,
          -0.6506642699241638,
          -0.6875365972518921,
          -0.5780491828918457,
          -0.6639950275421143,
          -0.7118745446205139,
          -0.7265652418136597,
          -0.6978380680084229,
          -0.669331431388855,
          -0.6833899021148682,
          -0.7079921364784241,
          -0.6473429799079895,
          -0.6391509175300598,
          -0.66121506690979,
          -0.694511353969574,
          -0.6729590892791748,
          -0.6775918006896973,
          -0.7445787787437439,
          -0.7140803337097168,
          -0.6794818639755249,
          -0.7218798995018005,
          -0.7193442583084106,
          -0.7365556955337524,
          -0.6234706044197083,
          -0.6721377372741699,
          -0.7196508646011353,
          -0.6666544675827026,
          -0.6884221434593201,
          -0.7205015420913696,
          -0.7008695602416992,
          -0.7232686281204224,
          -0.7404654622077942,
          -0.6524094343185425,
          -0.6639897227287292,
          -0.6588074564933777,
          -0.6859205961227417,
          -0.6460450291633606,
          -0.6970943212509155,
          -0.6403821110725403,
          -0.590713620185852,
          -0.6866516470909119,
          -0.7102184891700745,
          -0.6871787309646606,
          -0.6784314513206482,
          -0.7148762345314026,
          -0.59140545129776,
          -0.6317095756530762,
          -0.6941012740135193,
          -0.60342937707901,
          -0.7029940485954285,
          -0.6710180044174194,
          -0.6960844397544861,
          -0.6550172567367554,
          -0.7377920150756836,
          -0.712030827999115,
          -0.6862949132919312,
          -0.6867167949676514,
          -0.589678943157196,
          -0.7079974412918091,
          -0.6908605694770813,
          -0.6927707195281982,
          -0.6220679879188538,
          -0.5931087732315063,
          -0.7063167095184326,
          -0.6367232203483582,
          -0.6716679334640503,
          -0.67460036277771,
          -0.7016118168830872,
          -0.6710525751113892,
          -0.6736706495285034,
          -0.7326424717903137
         ],
         "y": [
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0
         ]
        },
        {
         "type": "scatter",
         "x": [
          -0.7445787787437439,
          -0.7087740302085876,
          -0.6729692816734314,
          -0.6371645331382751,
          -0.6013597846031189,
          -0.5655550360679626,
          -0.5297502279281616,
          -0.49394550919532776,
          -0.4581407606601715,
          -0.42233601212501526,
          -0.386531263589859,
          -0.35072648525238037,
          -0.3149217367172241,
          -0.27911698818206787,
          -0.24331223964691162,
          -0.20750749111175537,
          -0.17170274257659912,
          -0.13589799404144287,
          -0.10009323805570602,
          -0.06428848206996918,
          -0.028483733534812927,
          0.007321015000343323,
          0.04312577843666077,
          0.07893052697181702,
          0.11473530530929565,
          0.1505400538444519,
          0.18634480237960815,
          0.2221495658159256,
          0.25795429944992065,
          0.2937590479850769,
          0.32956382632255554,
          0.3653685748577118,
          0.40117329359054565,
          0.4369780421257019,
          0.47278279066085815,
          0.5085875391960144,
          0.5443922877311707,
          0.5801970362663269,
          0.6160018444061279,
          0.6518065929412842,
          0.6876112818717957,
          0.7234160304069519,
          0.7592207789421082,
          0.7950255274772644,
          0.8308302760124207,
          0.8666350245475769,
          0.9024398326873779,
          0.9382445812225342,
          0.9740493893623352,
          1.0098541975021362,
          1.0456589460372925,
          1.0814636945724487,
          1.117268443107605,
          1.1530731916427612,
          1.1888779401779175,
          1.2246826887130737,
          1.2604871988296509,
          1.2962919473648071,
          1.3320966958999634,
          1.3679014444351196,
          1.4037061929702759,
          1.4395109415054321,
          1.4753156900405884,
          1.5111204385757446,
          1.5469251871109009,
          1.5827299356460571,
          1.6185346841812134,
          1.6543394327163696,
          1.6901441812515259,
          1.7259489297866821,
          1.7617536783218384,
          1.7975584268569946,
          1.8333631753921509,
          1.8691679239273071,
          1.9049726724624634,
          1.9407774209976196,
          1.9765821695327759,
          2.0123870372772217,
          2.048191785812378,
          2.083996534347534,
          2.1198012828826904,
          2.1556060314178467,
          2.191410779953003,
          2.227215528488159,
          2.2630202770233154,
          2.2988250255584717,
          2.334629774093628,
          2.370434522628784,
          2.4062392711639404,
          2.4420440196990967,
          2.477848768234253,
          2.513653516769409,
          2.5494582653045654,
          2.5852630138397217,
          2.621067762374878,
          2.656872510910034,
          2.6926772594451904,
          2.7284820079803467,
          2.764286756515503,
          2.800091505050659
         ],
         "y": [
          0.633583128452301,
          0.6301400065422058,
          0.6266836524009705,
          0.6232142448425293,
          0.6197322010993958,
          0.6162377595901489,
          0.6127312779426575,
          0.60921311378479,
          0.6056835651397705,
          0.602142870426178,
          0.5985915064811707,
          0.5950297713279724,
          0.5914579629898071,
          0.5878764986991882,
          0.5842857360839844,
          0.5806859731674194,
          0.5770775675773621,
          0.5734609961509705,
          0.569836437702179,
          0.5662044882774353,
          0.5625653862953186,
          0.5589194893836975,
          0.5552672743797302,
          0.5516090393066406,
          0.5479452610015869,
          0.5442762970924377,
          0.540602445602417,
          0.5369241833686829,
          0.5332419276237488,
          0.5295560956001282,
          0.5258669853210449,
          0.5221750140190125,
          0.5184807181358337,
          0.5147843360900879,
          0.5110862851142883,
          0.5073870420455933,
          0.5036870837211609,
          0.4999866485595703,
          0.49628618359565735,
          0.4925861358642578,
          0.4888869524002075,
          0.4851889908313751,
          0.4814925789833069,
          0.4777982831001282,
          0.4741063416004181,
          0.47041723132133484,
          0.46673139929771423,
          0.46304917335510254,
          0.4593709707260132,
          0.4556971490383148,
          0.4520282447338104,
          0.4483644366264343,
          0.4447062611579895,
          0.441054105758667,
          0.4374082684516907,
          0.43376919627189636,
          0.4301372766494751,
          0.42651286721229553,
          0.42289629578590393,
          0.4192880094051361,
          0.41568827629089355,
          0.4120975732803345,
          0.40851619839668274,
          0.4049444794654846,
          0.40138277411460876,
          0.3978314995765686,
          0.394290953874588,
          0.39076143503189087,
          0.3872433304786682,
          0.3837369680404663,
          0.38024258613586426,
          0.3767606317996979,
          0.37329137325286865,
          0.3698350489139557,
          0.36639204621315,
          0.36296263337135315,
          0.35954707860946655,
          0.3561457395553589,
          0.3527587950229645,
          0.34938663244247437,
          0.34602946043014526,
          0.34268754720687866,
          0.33936119079589844,
          0.3360505700111389,
          0.33275601267814636,
          0.3294777274131775,
          0.3262158930301666,
          0.3229708969593048,
          0.3197427988052368,
          0.31653183698654175,
          0.31333833932876587,
          0.31016242504119873,
          0.30700430274009705,
          0.30386418104171753,
          0.3007422089576721,
          0.2976386249065399,
          0.29455357789993286,
          0.2914872169494629,
          0.2884397506713867,
          0.2854112982749939
         ]
        }
       ],
       "layout": {
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "#E5ECF6",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "white"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "#E5ECF6",
          "polar": {
           "angularaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "radialaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "yaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "zaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "caxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          }
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import plotly.graph_objects as go\n",
    "fig = go.Figure()\n",
    "fig.add_trace(\n",
    "    go.Scatter(x=df[\"weight\"], y=df[\"obese\"]*1)\n",
    ")\n",
    "fig.add_trace(\n",
    "    go.Scatter(x=x.squeeze().detach().numpy(), y=y.squeeze().detach().numpy())\n",
    ")\n",
    "\n",
    "fig"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parameter containing:\n",
      "tensor([[0.0104]], requires_grad=True)\n",
      "Parameter containing:\n",
      "tensor([-0.1648], requires_grad=True)\n"
     ]
    }
   ],
   "source": [
    "for x in learner.model.parameters():\n",
    "    print(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "from torch import nn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "loss = nn.BCELoss()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor(0.0010)"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "loss(torch.FloatTensor([0.999]),torch.FloatTensor([1.0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor(0.)"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nn.BCEWithLogitsLoss()(torch.FloatTensor([-20]),torch.FloatTensor([0.0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "learner = app.learner(csv=csv_path, x=\"weight\", y=\"obese\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "batch = learner.dls.train.one_batch()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "batch[0].shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "batch[1].dtype"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import torch\n",
    "from torch import nn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "loss = nn.BCEWithLogitsLoss()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x = torch.Tensor([-1,1.5])\n",
    "y = torch.Tensor([False,False])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "loss(x,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y.dtype"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from fastai.metrics import accuracy, APScoreBinary"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "APScoreBinary()(x,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "def logit_accuracy(predictions, target):\n",
    "    return ((predictions > 0.0) == (target > 0.5)).float().mean()\n",
    "    predicted_positives = (predictions > 0.0)\n",
    "    predicted_negatives = ~predicted_positives\n",
    "    actual_positives = (target > 0.5)\n",
    "    actual_negatives = ~actual_positives\n",
    "    true_positives = (predicted_positives == actual_positives).sum()\n",
    "    true_negatives = (predicted_negatives == actual_negatives).sum()\n",
    "\n",
    "    print()\n",
    "\n",
    "    return (true_positives + true_negatives)/(actual_positives.sum() + actual_negatives.sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "logit_accuracy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "~(torch.Tensor([0.2, -0.2]) > 0.0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import f1_score\n",
    "def logit_f1(logits, target):\n",
    "    predictions = (logits > 0.0)\n",
    "    target_binary = (target > 0.5)\n",
    "    return f1_score(predictions.cpu(), target_binary.cpu())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "logits = torch.Tensor([-1,1.5,1.0, 0.5, -0.1, -0.1, -0.1])\n",
    "actual = torch.Tensor([False,True, True, True, True, True, False])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor(0.7143)"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logit_accuracy(logits,actual)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7499999999999999"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logit_f1(logits,actual)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "accuracy(x,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "04823184ed011c1bdcb4507ba592a8d7dc72412185dfb20b36adb38487ccbe63"
  },
  "kernelspec": {
   "display_name": "Python 3.9.10 ('.venv': poetry)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.10"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
